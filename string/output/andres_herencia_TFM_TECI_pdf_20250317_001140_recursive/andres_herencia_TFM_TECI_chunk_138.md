f{q,k} (xm, m, i) =

(cid:32)

cos mθ − sin mθ
cos mθ
sin mθ

(cid:33) (cid:32)

W (i,i)
W (i+1,i)

{q,k} W (i,i+1)
{q,k} W (i+1,i+1)

{q,k}

{q,k}

(cid:19)

(cid:33) (cid:18) x(i)
m
x(i+1)
m

(3.11)

being q and k the sub-index for the query and key sets, and xm the input with absolute
position m. In higher dimensional spaces, vectors are split into 2D chunks, so each pair
is rotated individually. This mechanism compounds the query-key cache. [58]